<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airdrop Wallet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .wallet {
            text-align: left;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .balance {
            font-size: 2em;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="font-sans bg-black text-white">
    <div class="container mx-auto p-4 flex justify-between items-center">
        <h1 class="text-2xl font-bold">SupremeAmer Crypto Wallet</h1>
        <button id="connect-wallet" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"> Connect Wallet </button>
        <button id="disconnect-wallet" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded ml-4 hidden"> Disconnect Wallet </button>
    </div>
    <div class="container mx-auto p-4">
        <div id="wallet-details" class="text-left">
            <p id="wallet-address" class="font-semibold"></p>
            <p id="balance" class="text-lg font-bold">Balance:</p>
            
<select id="currency-select">
    <option value="NGN">NGN</option>
    <option value="USD">USD</option>
    <option value="RUB">RUB</option>
    <option value="KWD">KWD</option>
    <option value="ETH">ETH</option>
    <option value="USDT">USDT</option>
</select>
<p id="selected-currency-balance"></p>
             <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .wallet {
            text-align: left;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .balance {
            font-size: 2em;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="wallet">
        <h1>SupremeAmer Wallet</h1>
        <div class="balance" id="balance">$SA: 0</div>
        <button onclick="window.location.href='index.html'">Go to Mining Page</button>
    </div>



        </div>
        <div id="additional-actions" class="mt-6 text-center hidden">
            <button id="send-button" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mb-4"> Send </button>
            <button id="receive-button" class="bg-indigo-500 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded mb-4"> Receive </button>
            <button id="history-button" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mb-4"> History </button>
        </div>
        <!-- Existing Send, Receive, and History Buttons -->
        <div class="buttons">
            <button id="send">Send</button>
            <button id="receive">Receive</button>
            <button id="history">History</button>
        </div>
        <!-- Add Ethereum Live Chart -->
        <div id="ethereum-chart" style="margin-top: 20px;">
            <!-- TradingView Widget -->
            <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
            <script type="text/javascript">
                new TradingView.widget({
                    "width": "100%",
                    "height": 400,
                    "symbol": "BINANCE:ETHUSDT",
                    "interval": "D",
                    "timezone": "Etc/UTC",
                    "theme": "dark",
                    "style": "1",
                    "locale": "en",
                    "toolbar_bg": "#f1f3f6",
                    "enable_publishing": false,
                    "hide_top_toolbar": true,
                    "hide_legend": false,
                    "save_image": false,
                    "container_id": "ethereum-chart"
                });
               
            </script>
        </div>
    </div>
    
    <div id="import-token-section">
        <h2>Import Token</h2>
        <input type="text" id="contract-address" placeholder="Enter Token Contract Address">
        <button id="import-token">Import Token</button>
    </div>
    <!-- Footer with Home, Dapp, and Discover Buttons -->
   
    <div class="wallet">
        <h1>SupremeAmer Wallet</h1>
        <div class="balance" id="balance">$SA: 0</div>
        <button onclick="window.location.href='index.html'">Go to Mining Page</button>
    </div>

    <script>
        // Load the balance from local storage
        function loadBalance() {
            const balance = localStorage.getItem('minedCoins') || 0;
            document.getElementById('balance').textContent = `$SA: ${parseFloat(balance).toFixed(4)}`;
        }

        // Load balance on page load
        window.onload = loadBalance;
        document.addEventListener('DOMContentLoaded', () => {
  const connectWalletButton = document.getElementById('connect-wallet');
  const disconnectWalletButton = document.getElementById('disconnect-wallet');
  const walletAddressDiv = document.getElementById('wallet-address');
  const balanceDiv = document.getElementById('balance');
  const additionalActionsDiv = document.getElementById('additional-actions');
  const sendButton = document.getElementById('send-button');
  const receiveButton = document.getElementById('receive-button');
  const historyButton = document.getElementById('history-button');
  const miningBalanceDiv = document.getElementById('mining-balance');
  const miningStartButton = document.getElementById('start-mining');
  const importTokenButton = document.getElementById('import-token');
  const sacoinPriceDiv = document.getElementById('sacoin-price');
  const usdtPriceDiv = document.getElementById('usdt-price');
  const contractAddressInput = document.getElementById('contract-address');

  let web3;
  let connectedAccount = null;
  let miningInterval = null;
  let miningBalance = 0;
  const miningRate = 0.0007; // Mining rate (SA Points per second).

  // Initialize Web3 and check if MetaMask is installed
  if (typeof window.ethereum !== 'undefined') {
    web3 = new Web3(window.ethereum);

    // Load saved wallet address
    const savedAddress = localStorage.getItem('connectedAddress');
    if (savedAddress) {
      connectWallet(savedAddress);
    }

    connectWalletButton.addEventListener('click', async () => {
      try {
        // Request account access
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        connectedAccount = accounts[0];
        localStorage.setItem('connectedAddress', connectedAccount);
        connectWallet(connectedAccount);
      } catch (error) {
        console.error('Error connecting to wallet:', error);
        walletAddressDiv.textContent = 'Failed to connect wallet.';
      }
    });

    disconnectWalletButton.addEventListener('click', () => {
      connectedAccount = null;
      localStorage.removeItem('connectedAddress');
      walletAddressDiv.textContent = '';
      balanceDiv.textContent = '';
      connectWalletButton.classList.remove('hidden');
      disconnectWalletButton.classList.add('hidden');
      additionalActionsDiv.classList.add('hidden');
      clearInterval(miningInterval);
      miningBalanceDiv.textContent = '';
    });

    sendButton.addEventListener('click', () => {
      window.location.href = 'send.html';
    });

    receiveButton.addEventListener('click', () => {
      window.location.href = 'receive.html';
    });

    historyButton.addEventListener('click', () => {
      window.location.href = 'history.html';
    });

    miningStartButton.addEventListener('click', () => {
      if (!connectedAccount) {
        alert('Connect your wallet to start mining.');
        return;
      }
      startMining();
    });

    importTokenButton.addEventListener('click', async () => {
      const contractAddress = contractAddressInput.value;
      if (!web3.utils.isAddress(contractAddress)) {
        alert('Invalid contract address.');
        return;
      }

      try {
        await window.ethereum.request({
          method: 'wallet_watchAsset',
          params: {
            type: 'ERC20',
            options: {
              address: contractAddress,
              symbol: 'TOKEN',
              decimals: 18,
            },
          },
        });
        alert('Token imported successfully.');
      } catch (error) {
        console.error('Error importing token:', error);
        alert('Failed to import token.');
      }
    });

    async function connectWallet(address) {
      connectedAccount = address;
      walletAddressDiv.textContent = `Connected Wallet Address: ${address}`;
      console.log('Wallet connected:', address);

      // Show balance
      const balance = await web3.eth.getBalance(address);
      balanceDiv.textContent = `Balance: ${web3.utils.fromWei(balance, 'ether')} ETH`;

      // Toggle buttons
      connectWalletButton.classList.add('hidden');
      disconnectWalletButton.classList.remove('hidden');
      additionalActionsDiv.classList.remove('hidden');

      // Fetch live prices
      fetchLivePrices();
    }

    async function fetchLivePrices() {
      try {
        // Replace the URLs below with actual APIs for live prices
        const sacoinResponse = await fetch('https://api.example.com/sacoin-price');
        const usdtResponse = await fetch('https://api.example.com/usdt-price');

        const sacoinData = await sacoinResponse.json();
        const usdtData = await usdtResponse.json();

        sacoinPriceDiv.textContent = `SA Coin Price: $${sacoinData.price}`;
        usdtPriceDiv.textContent = `USDT Price: $${usdtData.price}`;
      } catch (error) {
        console.error('Error fetching live prices:', error);
      }
    }

    function startMining() {
      if (miningInterval) {
        alert('Mining is already in progress.');
        return;
      }

      miningInterval = setInterval(() => {
        miningBalance += miningRate;
        miningBalanceDiv.textContent = `Mining Balance: ${miningBalance.toFixed(4)} SA Points`;
      }, 1000);
    }
  } else {
    walletAddressDiv.textContent = 'MetaMask is not installed. Please install MetaMask and try again.';
    connectWalletButton.disabled = true;
  }
});

const connectWallet = async () => {
    if (typeof window.ethereum !== 'undefined') {
        try {
            const accounts = await window.ethereum.request({
                method: 'eth_requestAccounts',
            });
            console.log(accounts);

            if (window.ethereum && window.ethereum.isMetaMask) {
                console.log('MetaMask is installed and available');
            }

            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                console.log('Mobile device detected');
            }
        } catch (error) {
            console.error(error);
        }
    } else {
        console.log('MetaMask not detected');
    }
};

connectWallet();

const currencySelect = document.getElementById('currency-select');
const selectedCurrencyBalance = document.getElementById('selected-currency-balance');

const getBalance = async (currency) => {
    return Math.floor(Math.random() * 1000);
};

currencySelect.addEventListener('change', async () => {
    const selectedCurrency = currencySelect.value;
    const balance = await getBalance(selectedCurrency);
    selectedCurrencyBalance.innerText = `${selectedCurrency}: ${balance}`;
});

const initialCurrency = currencySelect.value;
getBalance(initialCurrency).then((balance) => {
    selectedCurrencyBalance.innerText = `${initialCurrency}: ${balance}`;
});
    </script>
</body>
</html>
